---

services:
  app:
    build: !reset
    environment:
      - CAPYBARA_SAVE_PATH=/opt/app/artifacts
    env_file: !reset[]
    image: ${DOCKER_APP_IMAGE}
    depends_on:
      - selenium
    volumes: !override
      - artifacts:/opt/app/artifacts
      - selenium_downloads:/opt/app/tmp/selenium_downloads
  
  db:
    env_file: !reset[]
    volumes: !reset

  iipsrv: 
    env_file: !reset[]
    volumes: !override
      - iipsrv_data:/iipsrv-data

  selenium:
    env_file: !reset[]
    volumes: !override
      - artifacts:/build

  selenium-chrome:
    env_file: !reset[]
    depends_on:
      -selenium

  adminer: !reset

volumes:
  artifacts:
  selenium_downloads:
  iipsrv_data:
